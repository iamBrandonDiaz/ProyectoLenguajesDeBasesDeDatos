<!DOCTYPE html>
<html data-bs-theme="dark" xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/xhtml">

<head th:replace="~{layout/template-new :: head}">
    <title>COMAVI</title>
</head>

<body>
    <!-- Seccion del Titulo Agregar -->
    <section th:fragment="titulo-agregar">
        <div class="py-2 text-center">
            <svg class="d-block mx-auto mb-2" fill="#ffffff" width="72px" height="72px" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" stroke="#ffffff">
                <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                <g id="SVGRepo_iconCarrier">
                    <path d="M14.844 20H6.5C5.121 20 4 18.879 4 17.5S5.121 15 6.5 15h7c1.93 0 3.5-1.57 3.5-3.5S15.43 8 13.5 8H8.639a9.812 9.812 0 0 1-1.354 2H13.5c.827 0 1.5.673 1.5 1.5s-.673 1.5-1.5 1.5h-7C4.019 13 2 15.019 2 17.5S4.019 22 6.5 22h9.593a10.415 10.415 0 0 1-1.249-2zM5 2C3.346 2 2 3.346 2 5c0 3.188 3 5 3 5s3-1.813 3-5c0-1.654-1.346-3-3-3zm0 4.5a1.5 1.5 0 1 1 .001-3.001A1.5 1.5 0 0 1 5 6.5z"></path>
                    <path d="M19 14c-1.654 0-3 1.346-3 3 0 3.188 3 5 3 5s3-1.813 3-5c0-1.654-1.346-3-3-3zm0 4.5a1.5 1.5 0 1 1 .001-3.001A1.5 1.5 0 0 1 19 18.5z"></path>
                </g>
            </svg>
            <h2>Nuevo Pedido</h2>
            <p class="lead text-center" style="margin-left: 8rem; margin-right: 8rem;">
                Por favor, proceda a completar el siguiente formulario con los detalles del nuevo pedido que desea agregar. Podrá modificar sus datos una vez se haya creado con éxito.
            </p>
        </div>
    </section>

    <!-- Seccion de formulario Agregar -->
    <section th:fragment="agregar">
        <div class="d-flex justify-content-center">
            <div style="max-width: 40rem;">

                <!-- Información General -->
                <h4 class="mb-3">Información General</h4>
                <form th:action="@{/pedidos/add}"
                    method="POST"
                    class="needs-validation" novalidate="">
                    <div class="row g-3">

                        <!-- Cliente asociado -->
                        <div class="col-12">
                            <label for="idCliente" class="form-label">Cliente Asociado</label>
                            <select class="form-select" id="idCliente" name="idCliente" required="">
                                <option value="">Seleccione...</option>
                                <option th:each="cliente : ${clientes}" th:value="${cliente.idCliente}">[[${cliente.idCliente + ': ' + cliente.nombre + ' ' + cliente.apellido}]]</option>
                            </select>
                            <div class="invalid-feedback">
                                Por favor, seleccione un cliente.
                            </div>
                        </div>

                        <!-- Vehiculo asociado -->
                        <div class="col-12">
                            <label for="idVehiculo" class="form-label">Vehículo Asociado</label>
                            <select class="form-select" id="idVehiculo" name="idVehiculo" required="">
                                <option value="">Seleccione...</option>
                                <option th:each="vehiculo : ${vehiculos}" th:value="${vehiculo.idVehiculo}">[[${vehiculo.idVehiculo + ': ' + vehiculo.marca + ' ' + vehiculo.modelo}]]</option>
                            </select>
                            <div class="invalid-feedback">
                                Por favor, seleccione un vehículo.
                            </div>
                        </div>

                        <!-- Licencia Empleado asociado -->
                        <div class="col-12">
                            <label for="idLicenciaEmpleado" class="form-label">Empleado Asociado</label>
                            <select class="form-select" id="idLicenciaEmpleado" name="idLicenciaEmpleado" required="">
                                <option value="">Seleccione...</option>
                                <option th:each="licenciaEmpleado : ${licenciasEmpleado}" th:value="${licenciaEmpleado.idLicenciaEmpleado}">[[${licenciaEmpleado.getLicencia.getTipo + ': ' + licenciaEmpleado.getEmpleado.getNombre + ' ' + licenciaEmpleado.getEmpleado.getApellido}]]</option>
                            </select>
                            <div class="invalid-feedback">
                                Por favor, seleccione un empleado.
                            </div>
                        </div>

                        <!-- Divisor -->
                        <hr class="my-4">

                        <!-- Información del empleo -->
                        <h4 class="mb-3">Información del Pedido</h4>

                        <!-- Tipo de Carga -->
                        <div class="col-12">
                            <label for="idVehiculo" class="form-label">Tipo de Carga</label>
                            <select class="form-select" id="idTipo" name="idTipo" required="">
                                <option value="">Seleccione...</option>
                                <option th:each="tipoCarga : ${tiposCarga}" th:value="${tipoCarga.idTipo}">[[${tipoCarga.descripcion}]]</option>
                            </select>
                            <div class="invalid-feedback">
                                Por favor, seleccione un tipo de carga.
                            </div>
                        </div>

                        <!-- Fecha del pedido -->
                        <div class="col-sm-6">
                            <label for="fechaPedido" class="form-label">Fecha del pedido</label>
                            <input type="date" class="form-control" id="fechaPedido" th:value="${fechaPedido}" name="fechaPedido" value="" required="">
                            <div class="invalid-feedback">
                                Una fecha válida es requerida.
                            </div>
                        </div>

                        <!-- Estado -->
                        <div class="col-sm-6">
                            <label for="idEstado" class="form-label">Estado</label>
                            <select class="form-select" id="idEstado" name="idEstado" required="">
                                <option value="">Seleccione...</option>
                                <option th:each="estado : ${estados}" th:value="${estado.idEstado}">[[${estado.descripcion}]]</option>
                            </select>
                            <div class="invalid-feedback">
                                Por favor, seleccione un tipo de carga.
                            </div>
                        </div>

                        <!-- Descripcion -->
                        <div class="col-12">
                            <label for="descripcion" class="form-label">Descripción</label>
                            <textarea class="form-control" id="descripcion" name="descripcion" placeholder="200KG de Cemento" required=""></textarea>
                            <div class="invalid-feedback">
                                Por favor, ingrese una descripción válida.
                            </div>
                        </div>

                        <hr class="my-4">

                        <button class="w-100 btn btn-primary btn-lg" type="submit">Crear pedido</button>
                </form>
            </div>
        </div>
    </section>

    <!-- Seccion de ver listado -->
    <section th:fragment="ver">
        <div class="d-flex justify-content-center">
            <div th:if="${pedidos != null and !pedidos.empty}" style="width: 80rem;">
                <table class="table">
                    <thead>
                      <tr>
                        <th scope="col">ID</th>
                        <th scope="col">Descripción</th>
                        <th scope="col">Cliente</th>
                        <th scope="col">Vehículo</th>
                        <th scope="col">Fecha</th>
                        <th scope="col">Estado</th>
                        <th scope="col">Acciones</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr th:each="pedido : ${pedidos}">
                        <th scope="row">[[${pedido.idPedido}]]</th>
                        <td>[[${pedido.descripcion}]]</td>
                        <td>[[${pedido.getCliente.getNombre + ' ' + pedido.getCliente.getApellido}]]</td>                        
                        <td>[[${pedido.getVehiculo.getMarca + ' ' + pedido.getVehiculo.getModelo}]]</td>
                        <td>[[${pedido.fechaPedido}]]</td>
                        <td>[[${pedido.getEstado.getDescripcion}]]</td>
                        <td>
                            <!-- <a th:href="@{/pedidos/} + ${pedido.idPedido} + '/lic/ver'" class="btn btn-warning px-1 py-0">
                                <svg height="32px" width="32px" version="1.1" id="_x32_" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512" xml:space="preserve" fill="#000000">
                                    <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                                    <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                                    <g id="SVGRepo_iconCarrier">
                                        <style type="text/css">
                                            .st0 {
                                                fill: #000000;
                                            }
                                        </style>
                                        <g>
                                            <path class="st0" d="M464.932,85.797H47.068C21.076,85.797,0,106.865,0,132.865v246.271c0,25.991,21.076,47.067,47.068,47.067 h417.865c25.991,0,47.068-21.076,47.068-47.067V132.865C512,106.865,490.924,85.797,464.932,85.797z M123.254,167.399 c25.966,0,47.026,21.059,47.026,47.034c0,25.974-21.06,47.025-47.026,47.025c-25.974,0-47.025-21.051-47.025-47.025 C76.229,188.458,97.28,167.399,123.254,167.399z M123.254,348.916c-32.305,0-65.389-11.187-60.229-42.153 c2.102-12.576,12.508-30.203,20.407-38.102c1.016-1.017,5.652-1.28,6.915-0.5c9.585,5.907,20.839,9.364,32.907,9.364 c12.068,0,23.313-3.457,32.898-9.364c1.263-0.78,5.898-0.517,6.924,0.5c7.89,7.899,18.296,25.526,20.398,38.102 C188.636,337.729,155.551,348.916,123.254,348.916z M366.424,333.492H232.194v-27h134.229V333.492z M446.686,267.068H232.194v-27 h214.492V267.068z M446.686,200.644H232.194v-27h214.492V200.644z"></path>
                                        </g>
                                    </g>
                                </svg>
                            </a> -->
                            <a th:href="@{/pedidos/} + ${pedido.idPedido} + '/dir/ver'" class="btn btn-primary">Direcciones</a>
                            <a th:href="@{/pedidos/editar/} + ${pedido.idPedido}" class="btn btn-secondary">Editar</a>
                            <a th:href="@{/pedidos/eliminar/} + ${pedido.idPedido}" class="btn btn-danger">Eliminar</a>
                        </td>
                      </tr>
                    </tbody>
                  </table>
            </div>
            <div th:if="${pedidos == null or pedidos.empty}">
                <p class="lead text-center" style="margin-left: 8rem; margin-right: 8rem;">
                    No se encontraron pedidos registrados :(
                </p>
            </div>
        </div>
    </section>

    <!-- Seccion del Titulo Actualizar -->
    <section th:fragment="titulo-actualizar">
        <div class="py-2 text-center">
            
            <h2>Editar Pedido</h2>
            <p class="lead text-center" style="margin-left: 8rem; margin-right: 8rem;">
                Por favor, ingrese los nuevos datos del pedido. Una vez que haya completado el formulario, haga clic en el botón "Editar" para actualizar la información.
            </p>
        </div>
    </section>

    <!-- Seccion de formulario Actualizar -->
    <section th:fragment="actualizar">
        <div class="d-flex justify-content-center">
            <div style="max-width: 40rem;">

                <!-- Información de Contacto -->
                <h4 class="mb-3">Información de Contacto</h4>
                <form th:action="@{/pedidos/update}"
                    method="POST"
                    class="needs-validation" novalidate="">
                    <div class="row g-3">
                        <!-- ID -->
                        <input type="text" class="form-control" hidden name="idPedido" id="idPedido" th:value="${idPedido}" placeholder="" required="">


                        <!-- Cliente asociado -->
                        <div class="col-12">
                            <label for="idCliente" class="form-label">Cliente Asociado</label>
                            <select class="form-select" id="idCliente" name="idCliente" required="">
                                <option value="">Seleccione...</option>
                                <option th:each="cliente : ${clientes}" th:value="${cliente.idCliente}">[[${cliente.idCliente + ': ' + cliente.nombre + ' ' + cliente.apellido}]]</option>
                            </select>
                            <div class="invalid-feedback">
                                Por favor, seleccione un cliente.
                            </div>
                        </div>

                        <!-- Vehiculo asociado -->
                        <div class="col-12">
                            <label for="idVehiculo" class="form-label">Vehículo Asociado</label>
                            <select class="form-select" id="idVehiculo" name="idVehiculo" required="">
                                <option value="">Seleccione...</option>
                                <option th:each="vehiculo : ${vehiculos}" th:value="${vehiculo.idVehiculo}">[[${vehiculo.idVehiculo + ': ' + vehiculo.marca + ' ' + vehiculo.modelo}]]</option>
                            </select>
                            <div class="invalid-feedback">
                                Por favor, seleccione un vehículo.
                            </div>
                        </div>

                        <!-- Licencia Empleado asociado -->
                        <div class="col-12">
                            <label for="idLicenciaEmpleado" class="form-label">Empleado Asociado</label>
                            <select class="form-select" id="idLicenciaEmpleado" name="idLicenciaEmpleado" required="">
                                <option value="">Seleccione...</option>
                                <option th:each="licenciaEmpleado : ${licenciasEmpleado}" th:value="${licenciaEmpleado.idLicenciaEmpleado}">[[${licenciaEmpleado.getLicencia.getTipo + ': ' + licenciaEmpleado.getEmpleado.getNombre + ' ' + licenciaEmpleado.getEmpleado.getApellido}]]</option>

                            </select>
                            <div class="invalid-feedback">
                                Por favor, seleccione un empleado.
                            </div>
                        </div>

                        <!-- Divisor -->
                        <hr class="my-4">

                        <!-- Información del empleo -->
                        <h4 class="mb-3">Información del Pedido</h4>

                        <!-- Tipo de Carga -->
                        <div class="col-12">
                            <label for="idVehiculo" class="form-label">Tipo de Carga</label>
                            <select class="form-select" id="idTipo" name="idTipo" required="">
                                <option value="">Seleccione...</option>
                                <option th:each="tipoCarga : ${tiposCarga}" th:value="${tipoCarga.idTipo}">[[${tipoCarga.descripcion}]]</option>
                            </select>
                            <div class="invalid-feedback">
                                Por favor, seleccione un tipo de carga.
                            </div>
                        </div>

                        <!-- Fecha del pedido -->
                        <div class="col-sm-6">
                            <label for="fechaPedido" class="form-label">Fecha del pedido</label>
                            <input type="date" class="form-control" id="fechaPedido" th:value="${fechaPedido}" name="fechaPedido" value="" required="">
                            <div class="invalid-feedback">
                                Una fecha válida es requerida.
                            </div>
                        </div>

                        <!-- Estado -->
                        <div class="col-sm-6">
                            <label for="idEstado" class="form-label">Estado</label>
                            <select class="form-select" id="idEstado" name="idEstado" required="">
                                <option value="">Seleccione...</option>
                                <option th:each="estado : ${estados}" th:value="${estado.idEstado}">[[${estado.descripcion}]]</option>
                            </select>
                            <div class="invalid-feedback">
                                Por favor, seleccione un tipo de carga.
                            </div>
                        </div>

                        <!-- Descripcion -->
                        <div class="col-12">
                            <label for="descripcion" class="form-label">Descripción</label>
                            <textarea class="form-control" id="descripcion" th:value="${descripcion}" name="descripcion" placeholder="200KG de Cemento" required=""></textarea>
                            <div class="invalid-feedback">
                                Por favor, ingrese una descripción válida.
                            </div>
                        </div>
                        
                        <hr class="my-4">

                        <button class="w-100 btn btn-primary btn-lg" type="submit">Editar</button>
                </form>
            </div>
        </div>
    </section>
    

</body>
</html>